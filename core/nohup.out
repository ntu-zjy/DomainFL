build data Clipart classification head
  0%|          | 0/50 [00:00<?, ?it/s]  4%|▍         | 2/50 [00:00<00:02, 19.57it/s] 44%|████▍     | 22/50 [00:00<00:00, 123.79it/s] 84%|████████▍ | 42/50 [00:00<00:00, 157.09it/s]100%|██████████| 50/50 [00:00<00:00, 144.71it/s]
build data Painting classification head
  0%|          | 0/50 [00:00<?, ?it/s] 42%|████▏     | 21/50 [00:00<00:00, 203.69it/s] 84%|████████▍ | 42/50 [00:00<00:00, 200.83it/s]100%|██████████| 50/50 [00:00<00:00, 201.02it/s]
build data Real classification head
  0%|          | 0/50 [00:00<?, ?it/s] 42%|████▏     | 21/50 [00:00<00:00, 203.67it/s] 84%|████████▍ | 42/50 [00:00<00:00, 200.84it/s]100%|██████████| 50/50 [00:00<00:00, 201.05it/s]
build data Sketch classification head
  0%|          | 0/50 [00:00<?, ?it/s] 42%|████▏     | 21/50 [00:00<00:00, 202.61it/s] 84%|████████▍ | 42/50 [00:00<00:00, 201.07it/s]100%|██████████| 50/50 [00:00<00:00, 201.26it/s]
build data Quickdraw classification head
  0%|          | 0/50 [00:00<?, ?it/s] 42%|████▏     | 21/50 [00:00<00:00, 205.48it/s] 84%|████████▍ | 42/50 [00:00<00:00, 202.80it/s]100%|██████████| 50/50 [00:00<00:00, 203.07it/s]
build data Infograph classification head
  0%|          | 0/50 [00:00<?, ?it/s] 42%|████▏     | 21/50 [00:00<00:00, 204.96it/s] 84%|████████▍ | 42/50 [00:00<00:00, 203.31it/s]100%|██████████| 50/50 [00:00<00:00, 203.38it/s]
the parameters that require grad in clients[0].model: ['base.adapter.fc.0.weight', 'base.adapter.fc.2.weight']
==================== Round 0 ====================
Round 0 val loss: 432.9139
save finetuned local models
Round 0 best val loss: 432.9139, counter: 0
build data Clipart classification head
  0%|          | 0/50 [00:00<?, ?it/s]  8%|▊         | 4/50 [00:00<00:01, 38.46it/s] 36%|███▌      | 18/50 [00:00<00:00, 95.73it/s] 76%|███████▌  | 38/50 [00:00<00:00, 142.21it/s]100%|██████████| 50/50 [00:00<00:00, 136.17it/s]
build data Painting classification head
  0%|          | 0/50 [00:00<?, ?it/s] 42%|████▏     | 21/50 [00:00<00:00, 205.22it/s] 84%|████████▍ | 42/50 [00:00<00:00, 203.02it/s]100%|██████████| 50/50 [00:00<00:00, 202.94it/s]
build data Real classification head
  0%|          | 0/50 [00:00<?, ?it/s] 42%|████▏     | 21/50 [00:00<00:00, 204.62it/s] 84%|████████▍ | 42/50 [00:00<00:00, 201.37it/s]100%|██████████| 50/50 [00:00<00:00, 201.64it/s]
build data Sketch classification head
  0%|          | 0/50 [00:00<?, ?it/s] 42%|████▏     | 21/50 [00:00<00:00, 205.98it/s] 84%|████████▍ | 42/50 [00:00<00:00, 203.68it/s]100%|██████████| 50/50 [00:00<00:00, 203.63it/s]
build data Quickdraw classification head
  0%|          | 0/50 [00:00<?, ?it/s] 42%|████▏     | 21/50 [00:00<00:00, 205.23it/s] 84%|████████▍ | 42/50 [00:00<00:00, 202.16it/s]100%|██████████| 50/50 [00:00<00:00, 202.03it/s]
build data Infograph classification head
  0%|          | 0/50 [00:00<?, ?it/s] 42%|████▏     | 21/50 [00:00<00:00, 205.71it/s] 84%|████████▍ | 42/50 [00:00<00:00, 203.51it/s]100%|██████████| 50/50 [00:00<00:00, 203.27it/s]
the parameters that require grad in clients[0].model: ['base.adapter.fc.0.weight', 'base.adapter.fc.2.weight']
==================== Round 0 ====================
build data Clipart classification head
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:04, 19.85it/s] 22%|██▏       | 22/100 [00:00<00:00, 125.17it/s] 42%|████▏     | 42/100 [00:00<00:00, 158.46it/s] 62%|██████▏   | 62/100 [00:00<00:00, 173.95it/s] 82%|████████▏ | 82/100 [00:00<00:00, 182.07it/s]100%|██████████| 100/100 [00:00<00:00, 167.36it/s]
build data Painting classification head
  0%|          | 0/100 [00:00<?, ?it/s] 20%|██        | 20/100 [00:00<00:00, 199.11it/s] 40%|████      | 40/100 [00:00<00:00, 198.17it/s] 60%|██████    | 60/100 [00:00<00:00, 197.51it/s] 80%|████████  | 80/100 [00:00<00:00, 197.57it/s]100%|██████████| 100/100 [00:00<00:00, 198.13it/s]100%|██████████| 100/100 [00:00<00:00, 197.94it/s]
build data Real classification head
  0%|          | 0/100 [00:00<?, ?it/s] 21%|██        | 21/100 [00:00<00:00, 200.90it/s] 42%|████▏     | 42/100 [00:00<00:00, 194.28it/s] 62%|██████▏   | 62/100 [00:00<00:00, 195.85it/s] 82%|████████▏ | 82/100 [00:00<00:00, 196.02it/s]100%|██████████| 100/100 [00:00<00:00, 195.66it/s]
build data Sketch classification head
  0%|          | 0/100 [00:00<?, ?it/s] 21%|██        | 21/100 [00:00<00:00, 204.14it/s] 42%|████▏     | 42/100 [00:00<00:00, 201.90it/s] 63%|██████▎   | 63/100 [00:00<00:00, 200.11it/s] 84%|████████▍ | 84/100 [00:00<00:00, 199.95it/s]100%|██████████| 100/100 [00:00<00:00, 200.50it/s]
build data Quickdraw classification head
  0%|          | 0/100 [00:00<?, ?it/s] 21%|██        | 21/100 [00:00<00:00, 203.46it/s] 42%|████▏     | 42/100 [00:00<00:00, 200.87it/s] 63%|██████▎   | 63/100 [00:00<00:00, 200.48it/s] 84%|████████▍ | 84/100 [00:00<00:00, 200.35it/s]100%|██████████| 100/100 [00:00<00:00, 200.52it/s]
build data Infograph classification head
  0%|          | 0/100 [00:00<?, ?it/s] 20%|██        | 20/100 [00:00<00:00, 197.46it/s] 40%|████      | 40/100 [00:00<00:00, 195.60it/s] 60%|██████    | 60/100 [00:00<00:00, 194.97it/s] 80%|████████  | 80/100 [00:00<00:00, 194.05it/s]100%|██████████| 100/100 [00:00<00:00, 194.84it/s]100%|██████████| 100/100 [00:00<00:00, 194.89it/s]
the parameters that require grad in clients[0].model: ['base.adapter.fc.0.weight', 'base.adapter.fc.2.weight']
==================== Round 0 ====================
build data Clipart classification head
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:05, 19.24it/s] 18%|█▊        | 18/100 [00:00<00:00, 97.44it/s] 34%|███▍      | 34/100 [00:00<00:00, 122.87it/s] 54%|█████▍    | 54/100 [00:00<00:00, 150.83it/s] 74%|███████▍  | 74/100 [00:00<00:00, 167.26it/s] 95%|█████████▌| 95/100 [00:00<00:00, 179.31it/s]100%|██████████| 100/100 [00:00<00:00, 154.53it/s]
build data Painting classification head
  0%|          | 0/100 [00:00<?, ?it/s] 21%|██        | 21/100 [00:00<00:00, 206.30it/s] 42%|████▏     | 42/100 [00:00<00:00, 204.81it/s] 63%|██████▎   | 63/100 [00:00<00:00, 203.48it/s] 84%|████████▍ | 84/100 [00:00<00:00, 203.40it/s]100%|██████████| 100/100 [00:00<00:00, 203.85it/s]
build data Real classification head
  0%|          | 0/100 [00:00<?, ?it/s] 21%|██        | 21/100 [00:00<00:00, 205.85it/s] 42%|████▏     | 42/100 [00:00<00:00, 203.47it/s] 63%|██████▎   | 63/100 [00:00<00:00, 202.59it/s] 84%|████████▍ | 84/100 [00:00<00:00, 202.31it/s]100%|██████████| 100/100 [00:00<00:00, 202.73it/s]
Client 0 [Clipart] on all the other clients accuracy: [91.1099, 82.0397, 92.9308, 87.4439, 35.2, 68.75]
build data Sketch classification head
  0%|          | 0/100 [00:00<?, ?it/s] 21%|██        | 21/100 [00:00<00:00, 206.80it/s] 42%|████▏     | 42/100 [00:00<00:00, 197.60it/s] 62%|██████▏   | 62/100 [00:00<00:00, 191.65it/s] 82%|████████▏ | 82/100 [00:00<00:00, 167.50it/s]100%|██████████| 100/100 [00:00<00:00, 159.88it/s]100%|██████████| 100/100 [00:00<00:00, 170.72it/s]
build data Quickdraw classification head
  0%|          | 0/100 [00:00<?, ?it/s] 21%|██        | 21/100 [00:00<00:00, 200.09it/s] 42%|████▏     | 42/100 [00:00<00:00, 199.41it/s] 62%|██████▏   | 62/100 [00:00<00:00, 198.74it/s] 82%|████████▏ | 82/100 [00:00<00:00, 198.73it/s]100%|██████████| 100/100 [00:00<00:00, 199.07it/s]
build data Infograph classification head
  0%|          | 0/100 [00:00<?, ?it/s] 21%|██        | 21/100 [00:00<00:00, 203.88it/s] 42%|████▏     | 42/100 [00:00<00:00, 203.34it/s] 63%|██████▎   | 63/100 [00:00<00:00, 202.26it/s] 84%|████████▍ | 84/100 [00:00<00:00, 201.63it/s]100%|██████████| 100/100 [00:00<00:00, 202.10it/s]
the parameters that require grad in clients[0].model: ['base.adapter.fc.0.weight', 'base.adapter.fc.2.weight']
==================== Round 0 ====================
Round 0 val loss: 987.0263
save finetuned local models
Round 0 best val loss: 987.0263, counter: 0
Round 0 val loss: 430.3793
save finetuned local models
Round 0 best val loss: 430.3793, counter: 0
Client 1 [Painting] on all the other clients accuracy: [89.8399, 82.8329, 92.8901, 86.7713, 29.1067, 68.5592]
Round 0 val loss: 991.0627
save finetuned local models
Round 0 best val loss: 991.0627, counter: 0
Client 2 [Real] on all the other clients accuracy: [89.8399, 82.7479, 92.9851, 86.9315, 31.3867, 68.1775]
Client 0 [Clipart] on all the other clients accuracy: [91.6621, 85.9773, 93.2293, 87.8924, 33.7333, 74.4752]
Client 0 [Clipart] on all the other clients accuracy: [88.3864, 81.6787, 91.9855, 82.7284, 28.9867, 66.6766]
Client 3 [Sketch] on all the other clients accuracy: [90.0055, 81.5297, 93.0529, 87.6682, 34.1067, 67.5095]
